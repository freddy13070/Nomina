<?xml version="1.0"?>
  <database name="TRIGGER NL_VALIDADOR_ISR">
    <trigger name="NL_VALIDADOR_ISR" table="SPM_SLABLINE" fires="after" insert="true" update="false" delete="false" foreach="row">
      <body><![CDATA[IDSLABL VARCHAR(32);
IDSLAB VARCHAR(32);
ISR VARCHAR(1);
CUOTA NUMBER;
EXCEN NUMBER;
BEGIN
	/**************TRIGER QUE VALIDA QUE SI UN BLOQUE TIENE SELECCIONADO EL CHECK DEL ISR SEA OBLIGARTORIO LLENAR LOS CAMPOS DE CUOTA Y EXCENTE***/
	
	IDSLABL := :NEW.SPM_SLABLINE_ID;	

	SELECT SPM_SLAB_ID INTO IDSLAB FROM SPM_SLABLINE WHERE SPM_SLABLINE_ID = IDSLABL;

	SELECT EM_NL_ISR INTO ISR FROM SPM_SLAB WHERE SPM_SLAB_ID = IDSLAB;

	IF ISR = 'Y' THEN

				
		CUOTA := :NEW.EM_NL_CUOTA;
		EXCEN := :NEW.EM_NL_Excente;

		IF CUOTA IS NULL OR EXCEN IS NULL THEN

		RAISE EXCEPTION'%','@NL_ISR_NULL@';--OBTG:-20000--
		
		END IF;

	END IF;

	RETURN NEW;
END NL_VALIDADOR_ISR
]]></body>
    </trigger>
  </database>
